# 进阶设置

## 参考资料

小小输入法具有丰富和灵活的设置，详细说明可参阅两类资料：

* 作者 *dgod* 在[小小输入法论坛帮助版块](https://yong.dgod.net/index.php?c=thread&fid=7)发布的帖子
* 用户 *tairgo* 定期整理制作的[本地帮助文档](https://yong.dgod.net/read.php?tid=33)（`程序目录/doc/yong.chm`）。    
其中的**入门指南 🞂 专家设置**章节是对配置文件的详细说明，**其他说明 🞂 码表设置**章节是对码表文件的详细说明。

本章只是对以上参考资料中一些重点的提炼和补充。


## 修改配置文件

### 配置目录

<!-- tabs:start -->

## ** Windows **

在 Windows 系统中，配置目录一般是 `程序目录/.yong` 目录。特别地，如果输入法主程序安装在 `%ProgramFiles%` 或者 `%ProgramFiles(x86)%` 目录里，则配置目录是 `%APPDATA%/yong`。

## ** Android **

在 Android 系统中，配置目录一般是 `sdcard/yong/.yong`。

## ** Linux **

在 Linux 系统中，配置目录是 `~/.yong`。

<!-- tabs:end -->

### 配置文件

即 `配置目录/yong.ini`。其中的配置对所有方案都生效。修改保存（推荐采用 UTF-8 with BOM 编码）后，需要重载输入法（少部分配置需要重启输入法）以使设置生效。

?> 图形化配置程序 `yong-config.exe` 修改的也是此文件。

关于各设置项的说明参见[参考资料](#参考资料)，这里不赘述。

## 修改码表文件

码表文件分三类：造词文件、本地码表文件、在线码表。

### 造词文件

小小输入法自带造词和调频功能，与之相关的造词调频文件位于 `配置目录/方案名.usr`。普通用户不需要手动修改此文件，而是通过输入法自带的功能来造词、删词、调频等：

<!-- tabs:start -->

#### ** Windows **

1. 手动造词：把想造的词打上屏或复制 → <kbd>Ctrl</kbd><kbd>Insert</kbd> → 用 <kbd>↑</kbd>/<kbd>↓</kbd> 选中目标词 → 检查并修改编码 → 回车确认。
2. 自动造词：软件会自动将用户打出的字组词并编码，成为临时词，临时词在输入法重启后会丢失，但如果用户在丢失前用正确编码打出这个临时词，该词就会被记录到造词文件。
3. 删词：把自造词打出到候选栏，然后用 <kbd>Ctrl</kbd><kbd>Delete</kbd>。⚠ 注意，此功能在这种情况下会失效：当想删的词不是自造词（而是码表里的词），**且**没有重码（重码是指有两个以上不同词条的编码完全相同）时。
4. 手动调频：打出要调频的词到候选栏 → 用 <kbd>↑</kbd>/<kbd>↓</kbd> 选中目标词 → 用 <kbd>Ctrl</kbd><kbd>↑</kbd>/<kbd>↓</kbd> 调频。⚠ 注意，此功能仅在发生重码时有效。
5. 自动调频：默认未开启，此处不介绍。

#### ** Android **

?> 需要皮肤支持，先略，后续再补充。

<!-- tabs:end -->

### 本地码表文件

内置方案的本地码表文件位于 `配置目录/mb/方案ID` 目录，每次安装小小星空时都会被覆盖，因此**不建议用户修改**。用户应当[建立自己的方案](#建立自己的方案)。

### 在线码表

某些方案（如键道）的活跃用户创建的在线协作文档，所有人都可以参与维护。打开在线码表（`oomb` → `在线码表`，或通过输入法状态条右键菜单），按规则提交新词，就可能在下次版本更新时被收录到本地码表文件。

## 管理和制作方案

### 加载方案 · 卸载方案

在图形化配置程序 `yong-config.exe` 中，可以快速加载或卸载编码方案：

* 加载方案：在左侧树状视图中，右击 <kbd>输入法</kbd>，在右键菜单中选择要安装的方案，如下图左。
* 卸载方案：在左侧树状视图中，右击某个方案，在右键菜单中点 <kbd>删除</kbd>，如下图右。

![管理方案](_media\config-manage-schema.png)

?> 只有像内置方案那样，在 `entry` 目录下拥有入口文件的方案才可被图形化配置程序 `yong-config.exe` 识别并加载。如果没有入口文件，那么卸载后就无法在图形化配置程序中加载回来。

Android 系统没有图形化配置程序，只能手动加载或卸载编码方案：

* 加载方案：修改 `配置目录/yong.ini`，将方案的 `[方案ID]` 段（读取自该方案的入口文件）追加到 `[table]` 段之后，并在 `[IM]` 段中追加该方案的 `序号=方案ID` 键值对。
* 卸载方案：修改 `配置目录/yong.ini`，将方案的 `序号=方案ID` 键值对从 `[IM]` 段中剔除，并重新编排序号使其连续，同时删除 `[table]` 段后的该 `[方案ID]` 段。

### 建立自己的方案

一个方案最少应包括主码表文件和入口文件。

* 主码表文件：GB18030 编码的 txt 文件，格式参见 `mb/xkjd6/xkjd6_arg.txt` 和[参考资料](#参考资料)。
* 入口文件：UTF-8 编码的 ini 文件，格式参见 `entry/xkjd6_entry.ini` 和[参考资料](#参考资料)。文件必须放在 `entry` 目录下。入口文件的内容就是该方案的 `[方案ID]` 段。

准备好入口文件后，就可以在图形化配置程序 `yong-config.exe` 中快速加载或卸载自己的方案了。